{
	"info": {
		"_postman_id": "50283836-4d0642b0-734e-452e-987e-9e623d3e21bf",
		"name": "UserLoginModule-Ramya",
		"description": "Testing all the endpoints under User Login Controller:\n\n1. User Sign in\n    \n2. Forgot Password Confirm Email\n    \n3. Reset Password\n    \n4. User Logout",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "csvlogin",
			"item": [
				{
					"name": "/login1",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "cedde928-261b-41b5-9445-6ddec37b44d6",
								"exec": [
									"//Extract response from Json body of API response\r",
									"let json = pm.response.json();\r",
									"\r",
									"// Extract token from response\r",
									"let token = json.token;\r",
									"\r",
									"pm.test(\"Existing User logged in successfully\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"\r",
									"    // Save token to environment\r",
									"if (token) {\r",
									"      pm.globals.set(\"auth_token\", token);\r",
									"    console.log(\"Captured token:\", token);\r",
									"} else {\r",
									"    pm.test(\"Token not found\", function () {\r",
									"        pm.expect.fail(\"Response did not contain 'token' field\");\r",
									"    });\r",
									"}\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type header is present\", function () {\r",
									"    pm.response.to.have.header(\"Content-Type\");\r",
									"});\r",
									"if (pm.response.code === 400) {\r",
									"    //Extract message from response body\r",
									"    let errorMsg = json.message;\r",
									"\r",
									"    pm.test(\"Bad Request, Invalid details : \" + errorMsg, function () {\r",
									"        pm.response.to.have.status(400);\r",
									"    });\r",
									"}\r",
									"\r",
									"let resBody = {};\r",
									"try {\r",
									"    resBody = pm.response.json();\r",
									"} catch (e) {\r",
									"    // Response is not JSON or empty\r",
									"    resBody = {};\r",
									"}\r",
									"    if (pm.response.code === 415) {\r",
									"    let errorMsg = resBody.message || \"No message provided\";\r",
									"\r",
									"    pm.test(\"UNSUPPORTED_MEDIA_TYPE : \" + errorMsg, function () {\r",
									"        pm.response.to.have.status(415);\r",
									"    });\r",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "6a1190c9-d28d-4169-9f56-1925e211d6a2",
								"exec": [
									"// Get value from CSV column \"contentType\"\r",
									"let type = pm.variables.get(\"contentType\");   \r",
									"let mime = \"\";\r",
									"\r",
									"switch(type) {\r",
									"    case \"javascript\":\r",
									"        mime = \"application/javascript\";\r",
									"        break;\r",
									"    case \"xml\":\r",
									"        mime = \"application/xml\";\r",
									"        break;\r",
									"    case \"html\":\r",
									"        mime = \"text/html\";\r",
									"        break;\r",
									"    case \"json\":\r",
									"        mime = \"application/json\";\r",
									"        break;        \r",
									"}\r",
									"\r",
									"pm.request.headers.upsert({\r",
									"    key: \"Content-Type\",\r",
									"    value: mime\r",
									"});\r",
									"\r",
									"// Optional debug\r",
									"console.log(\"Using Content-Type:\", mime);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50283836-0a0ce390-ea53-42cd-9687-209185cddc10",
					"protocolProfileBehavior": {
						"disableBodyPruning": true,
						"disabledSystemHeaders": {
							"content-type": true
						}
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userLoginEmailId\": \"{{userLoginEmailId}}\",\r\n  \"password\": \"{{password}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/login",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "/loginN1",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "759ed3b4-f4ed-475b-b148-6b6481458e94",
								"exec": [
									"pm.test(\"Status code is 415\", function () {\r",
									"    pm.response.to.have.status(415);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type header is present\", function () {\r",
									"    pm.response.to.have.header(\"Content-Type\");\r",
									"});"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "b859f8c0-695a-4fda-b7e8-65c82414cff6",
								"exec": [
									"// Get value from CSV column \"contentType\"\r",
									"let type = pm.variables.get(\"contentType\");   \r",
									"let mime = \"\";\r",
									"\r",
									"switch(type) {\r",
									"    case \"javascript\":\r",
									"        mime = \"application/javascript\";\r",
									"        break;\r",
									"    case \"xml\":\r",
									"        mime = \"application/xml\";\r",
									"        break;\r",
									"    case \"html\":\r",
									"        mime = \"text/html\";\r",
									"        break;\r",
									"    case \"json\":\r",
									"        mime = \"application/json\";\r",
									"        break;        \r",
									"}\r",
									"\r",
									"pm.request.headers.upsert({\r",
									"    key: \"Content-Type\",\r",
									"    value: mime\r",
									"});\r",
									"\r",
									"// Optional debug\r",
									"console.log(\"Using Content-Type:\", mime);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50283836-23231f25-c6d8-4c34-982a-4a0c5fd4d730",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userLoginEmailId\": \"{{userLoginEmailId}}\",\r\n  \"password\": \"{{password}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/login",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "/loginN2",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "940d6859-f9d0-4b18-8ab1-f261afb6ec63",
								"exec": [
									"pm.test(\"Status code is 400\", function () {\r",
									"    pm.response.to.have.status(400);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type header is present\", function () {\r",
									"    pm.response.to.have.header(\"Content-Type\");\r",
									"});"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "50eceb66-fe25-4603-9438-72e1ec2a20f6",
								"exec": [
									"// Get value from CSV column \"contentType\"\r",
									"let type = pm.variables.get(\"contentType\");   \r",
									"let mime = \"\";\r",
									"\r",
									"switch(type) {\r",
									"    case \"javascript\":\r",
									"        mime = \"application/javascript\";\r",
									"        break;\r",
									"    case \"xml\":\r",
									"        mime = \"application/xml\";\r",
									"        break;\r",
									"    case \"html\":\r",
									"        mime = \"text/html\";\r",
									"        break;\r",
									"    case \"json\":\r",
									"        mime = \"application/json\";\r",
									"        break;        \r",
									"}\r",
									"\r",
									"pm.request.headers.upsert({\r",
									"    key: \"Content-Type\",\r",
									"    value: mime\r",
									"});\r",
									"\r",
									"// Optional debug\r",
									"console.log(\"Using Content-Type:\", mime);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50283836-ae23a597-e155-451e-93dd-771f8c1c35c4",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userLoginEmailId\": \"{{userLoginEmailId}}\",\r\n  \"password\": \"{{password}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/login",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"login"
							]
						}
					},
					"response": []
				}
			],
			"id": "50283836-bb9e5845-00b4-4bac-a545-94fe78a0f015"
		},
		{
			"name": "team2login",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "5cabcb04-4a31-4736-ac3e-df9f6d4aa457",
						"exec": [
							"let json = pm.response.json();\r",
							"\r",
							"// Extract token from response\r",
							"let token = json.token;\r",
							"\r",
							"// Save token to environment\r",
							"if (token) {\r",
							"    //pm.environment.set(\"team2_auth_token\", token);\r",
							"    pm.globals.set(\"team2_auth_token\", token);\r",
							"    console.log(\"Captured token:\", token);\r",
							"} else {\r",
							"    pm.test(\"Token not found\", function () {\r",
							"        pm.expect.fail(\"Response did not contain 'token' field\");\r",
							"    });\r",
							"}"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "7a714c49-b9f4-4133-ad8a-2798a14438b3",
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"id": "50283836-8664e6e0-beb7-4ef0-adcc-7b2738e287ef",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"userLoginEmailId\": \"team2@gmail.com\",\r\n  \"password\": \"ApiHackathon@2\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseURL}}/login",
					"host": [
						"{{baseURL}}"
					],
					"path": [
						"login"
					]
				}
			},
			"response": []
		},
		{
			"name": "logoutlms",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "7761c226-f018-4fa2-b945-27b202ea006b",
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"id": "50283836-8a0bbf35-b6a3-4f8f-a486-f075b70291da",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{auth_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseURL}}/logoutlms",
					"host": [
						"{{baseURL}}"
					],
					"path": [
						"logoutlms"
					]
				}
			},
			"response": []
		},
		{
			"name": "resetpassword",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "58db170a-bd1f-49a4-bba1-5f953b8ed103",
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "ebc6f702-01e5-4a42-9200-3d96fcc74ba8",
						"exec": [
							"// Function to generate random password\r",
							"function generatePassword(length) {\r",
							"    const uppercase = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r",
							"    const lowercase = \"abcdefghijklmnopqrstuvwxyz\";\r",
							"    const numbers   = \"0123456789\";\r",
							"    const special   = \"!@#$%^&*()-_=+<>?\";\r",
							"\r",
							"    const allChars = uppercase + lowercase + numbers + special;\r",
							"\r",
							"    let password = \"\";\r",
							"\r",
							"    // Ensure password has at least one of each type\r",
							"    password += uppercase.charAt(Math.floor(Math.random() * uppercase.length));\r",
							"    password += lowercase.charAt(Math.floor(Math.random() * lowercase.length));\r",
							"    password += numbers.charAt(Math.floor(Math.random() * numbers.length));\r",
							"    password += special.charAt(Math.floor(Math.random() * special.length));\r",
							"\r",
							"    // Add random characters\r",
							"    for (let i = password.length; i < length; i++) {\r",
							"        password += allChars.charAt(Math.floor(Math.random() * allChars.length));\r",
							"    }\r",
							"\r",
							"    // Shuffle to avoid predictable pattern\r",
							"    password = password.split('').sort(() => Math.random() - 0.5).join('');\r",
							"\r",
							"    return password;\r",
							"}\r",
							"\r",
							"// Generate password of length 12 (you can change length)\r",
							"let newPassword = generatePassword(12);\r",
							"\r",
							"// Save password in collection variable\r",
							"pm.collectionVariables.set(\"randomPassword\", newPassword);\r",
							"\r",
							"console.log(\"Generated Password:\", newPassword);\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"id": "50283836-106165aa-e876-412f-a1b4-d5ab95aa3be2",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"userLoginEmailId\": \"{{userEmail}}\",\r\n  \"password\": \"{{randomPassword}}\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseURL}}/resetPassword",
					"host": [
						"{{baseURL}}"
					],
					"path": [
						"resetPassword"
					]
				}
			},
			"response": []
		},
		{
			"name": "forgotpassword",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "65628fdd-6063-4298-893e-efbc0be0c437",
						"exec": [
							"let currentEnvironment = pm.environment.name;\r",
							"let roleId = pm.environment.get(\"roleId\");\r",
							"// Extract token from response\r",
							"let token = json.token;\r",
							"\r",
							"    if (currentEnvironment === \"Team02_LMS_API_Admin\") {\r",
							"        if (roleId === \"R01\"){\r",
							"        if (token) {\r",
							"            pm.environment.set(\"auth_token\", token);\r",
							"                console.log(\"Captured token:\", token);\r",
							"            } else {\r",
							"                pm.test(\"Token not found\", function () {\r",
							"                    pm.expect.fail(\"Response did not contain 'token' field\");\r",
							"                });\r",
							"            }\r",
							"        }};\r",
							"    if (currentEnvironment === \"Team02_LMS_API_Staff\") {\r",
							"       if (roleId === \"R02\"){\r",
							"        if (token) {\r",
							"            pm.environment.set(\"auth_token\", token);\r",
							"            console.log(\"Captured token:\", token);\r",
							"            } else {\r",
							"                pm.test(\"Token not found\", function () {\r",
							"                    pm.expect.fail(\"Response did not contain 'token' field\");\r",
							"                });\r",
							"            }\r",
							"        }};\r",
							"    if (currentEnvironment === \"Team02_LMS_API_Student\") {\r",
							"        if (roleId === \"R03\"){\r",
							"        if (token) {\r",
							"            pm.environment.set(\"auth_token\", token);\r",
							"                console.log(\"Captured token:\", token);\r",
							"            } else {\r",
							"                pm.test(\"Token not found\", function () {\r",
							"                    pm.expect.fail(\"Response did not contain 'token' field\");\r",
							"                });\r",
							"            }\r",
							"        }};"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"id": "50283836-a9baa484-1cb3-4bbc-b6dc-f2723080d487",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{auth_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"userLoginEmailId\": \"{{userEmail}}\"\r\n}"
				},
				"url": {
					"raw": "{{baseURL}}/login/forgotpassword/confirmEmail",
					"host": [
						"{{baseURL}}"
					],
					"path": [
						"login",
						"forgotpassword",
						"confirmEmail"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "b5f8ede1-db11-4fe3-9f19-1b6c14a31c45",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "a4b612e6-0e81-41d2-8547-ff8b3d285f3c",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	]
}